# 実装状況詳細

このドキュメントでは、英文構造解析アプリケーションの各機能の実装状況について詳細を記述します。

## 品詞 (Part-of-Speech - POS)

*   **機能:** 文中の各単語の品詞を識別し、日本語で表示します。
*   **実装状況:** 完全に実装済み。
*   **技術詳細:**
    *   `spaCy` ライブラリの品詞タグ付け機能 (`token.pos_`) を使用しています。
    *   `analyzer.py` 内の `pos_map` を用いて、`spaCy` の品詞タグを日本語に変換しています。
    *   句読点 (`PUNCT`) については、`token.text` の内容（`.` や `,` など）に応じて「句読点 (ピリオド)」「句読点 (カンマ)」のように詳細に表示されます。
    *   `analyzer.py` の `_analyze_sentence` メソッド内で `pos_tagged_text` を生成する際に、主語と述語（主動詞）に色付けを行っています。

## 句 (Phrase)

*   **機能:** 文中の単語のまとまりである句を識別し、表示します。
*   **実装状況:** 主要な句（名詞句、動詞句、前置詞句）の識別と表示は実装済み。
*   **技術詳細:**
    *   **名詞句 (Noun Phrase):** `spaCy` の `doc.noun_chunks` 機能を使用して識別しています。`app.py` の `analyze_and_format_text` 関数内で名詞句を優先的に処理し、`SyntaxElement` として構築しています。名詞句のルートトークン (`chunk.root`) の依存関係 (`token.dep_`) に基づいて、「主語」「直接目的語」などの役割を `get_noun_phrase_role` 関数で判断し、表示に反映しています。
    *   **動詞句 (Verb Phrase):** 動詞 (`VERB`) や助動詞 (`AUX`) を中心に、その関連語（助動詞など）をまとめて識別しています。`get_verb_phrase_role` 関数で「述語 (主動詞)」「述語 (連結動詞)」などの役割を判断し、表示に反映しています。
    *   **前置詞句 (Prepositional Phrase):** 前置詞 (`ADP`) とそれに続く目的語 (`pobj`) を持つ単語群を識別しています。`get_prepositional_phrase_role` 関数で「副詞的修飾 (場所)」「形容詞的修飾 (名詞)」などの役割を判断し、表示に反映しています。
    *   各句の内部では、個々の単語とその品詞がインデントされて表示されます。

## 節 (Clause)

*   **機能:** 文中の節を識別し、表示します。
*   **実装状況:** 従属節の識別と表示は実装済み。
*   **技術詳細:**
    *   `spaCy` の依存関係解析 (`token.dep_`) を利用し、`advcl` (副詞節)、`acl` (形容詞節)、`ccomp` (補文)、`xcomp` (開補文)、`relcl` (関係節) などの依存関係を持つトークンを節のルートとして識別しています。
    *   `get_clause_role` 関数で、接続詞 (`SCONJ`) や依存関係に基づいて「副詞節 (原因・理由)」「形容詞節」などの役割を判断し、表示に反映しています。
    *   主節は、従属節として識別されなかった残りの部分として扱われます。

---

**今後の改善点:**

*   より複雑な動詞句（例: 助動詞を含む動詞句）のより詳細な識別と表示。
*   形容詞句や副詞句のより厳密な識別と表示。
*   主節の内部構造（主語、述語、目的語、補語など）のより詳細な表示。