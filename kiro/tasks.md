# 英文構文解析・強調表示 Web アプリ - 開発タスクリスト

## 1. 環境構築と初期設定

*   [ ] プロジェクトリポジトリの作成と初期コミット
*   [ ] `requirements.txt` に `streamlit` と `spacy` を追加
*   [ ] `app.py` ファイルの作成とStreamlitアプリの初期起動確認
*   [ ] spaCy英語モデルのダウンロードコマンドの実行 (例: `python -m spacy download en_core_web_sm`)
*   [ ] `.streamlit/config.toml` でテーマ設定（任意）
*   [ ] **Black, isort, Flake8/Ruff などの静的解析ツールの導入と設定**

## 2. コア機能の実装

### 2.1. UIのスケルトン作成
*   [ ] `st.text_area` で英文入力ボックスを配置
*   [ ] `st.button` で「解析実行」ボタンと「クリア」ボタンを配置
*   [ ] `st.empty` または `st.markdown` で解析結果表示用のプレースホルダーを配置

### 2.2. spaCyモデルのロードロジックの実装
*   [ ] アプリ起動時に一度だけspaCyモデルをロードする (`st.cache_resource` を利用)

### 2.3. テキスト解析ロジックの実装
*   [ ] 入力テキストをspaCyで処理し、`Doc`オブジェクトを生成する関数を作成
*   [ ] `Doc`オブジェクトから名詞句 (`doc.noun_chunks`) と動詞句を識別するロジックを実装
*   [ ] `Doc`オブジェクトから主語 (`token.dep_ == 'nsubj'`) と動詞 (`token.pos_ == 'VERB'`) を特定するロジックを実装
*   [ ] **複数文の分割と各文の解析ロジックを実装**
*   [ ] **複雑な構文パターン（関係代名詞節、分詞構文など）への対応ロジックを実装**

## 3. 結果表示ロジックの実装

### 3.1. 括弧表示のロジック
*   [ ] 名詞句、動詞句の`Span`オブジェクトから、元のテキストに括弧を挿入した文字列を生成する関数を作成
*   [ ] **句のネスト（入れ子構造）を考慮した括弧表示ロジックを実装**

### 3.2. 主語・動詞の色付けロジック
*   [ ] 特定された主語と動詞のトークンをHTMLの `<span>` タグで囲み、カスタムCSSクラスを適用する関数を作成
*   [ ] **色付け以外の強調スタイル（太字、下線、背景色など）を適用するロジックを実装**

### 3.3. 結果の統合表示
*   [ ] 括弧表示と色付けを組み合わせた最終的なHTML文字列を生成する関数を作成
*   [ ] 生成されたHTMLを `st.markdown(unsafe_allow_html=True)` で表示
*   [ ] **インタラクティブな表示（マウスオーバー時のツールチップなど）の検討と実装**
*   [ ] **表示オプション（表示レベル、元の文との切り替え）の実装**
*   [ ] **解析結果のダウンロード機能（HTML, TXT, JSON形式）の実装**

## 4. 全体統合と品質向上

*   [ ] 「解析実行」ボタンクリック時の処理フローを実装 (入力取得 -> 解析 -> 結果整形 -> 表示)
*   [ ] 「クリア」ボタンクリック時の処理フローを実装 (入力エリアと結果表示をクリア)
*   [ ] `st.session_state` を利用して、入力テキストや解析結果の状態を管理
*   [ ] エラーハンドリングの実装 (例: 空の入力、非英語の入力に対するメッセージ表示)
*   [ ] **入力のバリデーションとフィードバック（英文判定など）の実装**
*   [ ] UI/UXの調整 (Streamlitの標準機能範囲内で、視覚的な改善)
*   [ ] レスポンシブデザインの確認 (PCとスマートフォンでの表示崩れがないか)
*   [ ] **アクセシビリティ（色覚多様性対応など）の考慮と実装**
*   [ ] パフォーマンスのテストと最適化 (特に長いテキストの処理速度)
*   [ ] **オンボーディングとヘルプ機能の実装（初回アクセス時の説明、ツールチップなど）**
*   [ ] **フィードバックメッセージの強化（解析完了メッセージ、より分かりやすいエラーメッセージ）**
*   [ ] **SentenceAnalyzer, ResultFormatter などのモジュール化とファイル分割**
*   [ ] **ユニットテストの作成（pytest を使用）**

## 5. デプロイ

*   [ ] `requirements.txt` の最終化 (必要なライブラリとそのバージョンを正確に記載)
*   [ ] Streamlit Community Cloud もしくは他のホスティングサービスへのデプロイ手順を確認し、実行
